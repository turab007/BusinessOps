<mat-card class="user-card">

    <mat-card-header>
        <mat-card-title>KanBan</mat-card-title>
        <mat-card-subtitle></mat-card-subtitle>
        <div td-toolbar-content layout="row" layout-align="center center" flex>
            <span flex></span>
            <mat-list-item>
                <span>
                    <button mat-icon-button [mat-menu-trigger-for]="menu" style="margin-top:3px;">
                        <mat-icon>more_vert</mat-icon>
                    </button>
                    <mat-menu x-position="before" #menu="matMenu">
                        <a [routerLink]="['/business-opps/opportunities']" mat-menu-item>
                            <mat-icon>list</mat-icon> List All
                        </a>
                        <a  [routerLink]="['/business-opps/opportunities/create']" mat-menu-item>
                            <mat-icon>create</mat-icon>Create
                        </a>
                    </mat-menu>
                </span>
            </mat-list-item>

        </div>
    </mat-card-header>
    <mat-card-content>

        <div layout="row" *ngIf="kanBanData">
            <mat-card flex *ngFor="let status of kanBanData.statuses">
                <mat-card-header>
                    <mat-card-title>{{status.name}}</mat-card-title>
                    <mat-card-subtitle></mat-card-subtitle>
                </mat-card-header>
                <mat-card-content [dragula]='"first-bag"' [attr.data-id]="status.id">
                    <!--<div *ngFor='let text of many' [innerHtml]='text'></div>-->

                    <div *ngFor="let opportunity of kanBanData.opportunities[status.id]" [attr.data-id]="opportunity._id">
                        <mat-card>
                            <mat-card-content>
                                <div class="mat-title _id">{{opportunity.name}}</div>
                                <p mat-line *ngIf="opportunity.company_id">
                                    <span> {{opportunity.company_id.name}}</span> 
                                </p>
                                <p mat-line *ngIf="opportunity.company_name">
                                    <span> {{opportunity.company_name}}</span> 
                                </p>
                                <p mat-line *ngIf="opportunity.contact_id">
                                    <span> {{opportunity.contact_id.name}}</span> 
                                </p>
                                <p mat-line *ngIf="opportunity.contact_name">
                                    <span> {{opportunity.contact_name}}</span> 
                                </p>
                                <p mat-line>
                                    <span> {{opportunity.description}}</span> 
                                </p>
                                 <p mat-line>
                                    <span> {{opportunity.createdAgo}}</span> 
                                </p>
                            </mat-card-content>
                        </mat-card>
                    </div>
                </mat-card-content>

            </mat-card>


        </div>
    </mat-card-content>

</mat-card>